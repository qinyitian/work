<!DOCTYPE html>
<html  xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>已发布招标项目表</title>
    <!-- Import google fonts - Heading first/ text second -->
    <!--[if lt IE 9]>
    <link href="http://fonts.useso.com/css?family=Open+Sans:400" rel="stylesheet" type="text/css" />
    <link href="http://fonts.useso.com/css?family=Open+Sans:700" rel="stylesheet" type="text/css" />
    <link href="http://fonts.useso.com/css?family=Droid+Sans:400" rel="stylesheet" type="text/css" />
    <link href="http://fonts.useso.com/css?family=Droid+Sans:700" rel="stylesheet" type="text/css" />
    <![endif]-->
    <!-- Favicon and touch icons -->
    <link rel="shortcut icon" href="../asset/ico/favicon.ico" type="image/x-icon" />
    <!-- Css files -->
    <link href="../asset/css/bootstrap.min.css" rel="stylesheet">
    <link href="../asset/css/jquery.mmenu.css" rel="stylesheet">
    <link href="../asset/css/font-awesome.min.css" rel="stylesheet">
    <link href="../asset/plugins/jquery-ui/css/jquery-ui-1.10.4.min.css" rel="stylesheet">
    <link href="../asset/css/style.min.css" rel="stylesheet">
    <link href="../asset/css/add-ons.min.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="../asset/js/html5shiv.js"></script>
    <script src="../asset/js/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- start: Header -->
<div class="navbar" role="navigation">
    <div class="container-fluid">
        <ul class="nav navbar-nav navbar-right">
            <li class="dropdown visible-md visible-lg">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><img class="user-avatar" src="../asset/img/avatar.jpg" alt="user-mail">政府后台管理员</a>
            </li>
            <li><a href="Home.html"><i class="fa fa-power-off"></i></a></li>
        </ul>
    </div>
</div>
<!-- end: Header -->
<!-- start:    左侧导航栏    -->
<div class="container-fluid content">
    <div class="row">
        <!-- start: Main Menu -->
        <div class="sidebar ">
            <div class="sidebar-collapse">
                <div class="sidebar-header t-center">
                   	<br>
                    <h2>政府后台</h2>
                </div>
                <div class="sidebar-menu">
                    <ul class="nav nav-sidebar">
                        <li><a href="../Admin_Index.html"><i class="fa fa-laptop"></i><span class="text">主页</span></a></li>
                        <li>
                            <a href="#"><i class="fa fa-font"></i><span class="text">首页管理</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="#"><i class="fa fa-th"></i><span class="text">头部导航栏管理</span></a></li>
                                <li><a href="#"><i class="fa fa-th"></i><span class="text">文章管理</span></a></li>
                                <li><a href="#"><i class="fa fa-th"></i><span class="text">内容管理</span></a></li>
                                <li><a href="#"><i class="fa fa-th"></i><span class="text">底部导航栏管理</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-signal"></i><span class="text">服务管理</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="/System_Service/equipment_service.html"><i class="fa fa-list"></i><span class="text">器材管理</span></a></li>
                                <li><a href="/System_Service/field_service.html"><i class="fa fa-list"></i><span class="text">场地服务管理</span></a></li>
                                <li><a href="/System_Service/activity_service.html"><i class="fa fa-list"></i><span class="text">活动服务管理</span></a></li>
                                <li><a href="/System_Service/sport_service.html"><i class="fa fa-list"></i><span class="text">赛事服务管理</span></a></li>
                                <li><a href="/System_Service/artificial_service.html"><i class="fa fa-list"></i><span class="text">人工服务管理</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-signal"></i><span class="text">需求</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="/System_Demand/demand_table_input.html"><i class="fa fa-table"></i><span class="text">需求调查表</span></a></li>
                                <li><a href="/System_Demand/demand_table_list.html"><i class="fa fa-list"></i><span class="text">调查表</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-file-text"></i><span class="text">招标</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="/System_TenderPlan/publish_tender_plan.html"><i class="fa fa-pencil"></i><span class="text">发布招标计划</span></a></li>
                                <!--<li><a href="/System_TenderPlan/goverment_check_evalution.html"><i class="fa fa-table"></i><span class="text">查看招标计划</span></a></li>-->
                                <li><a href="/System_TenderPlan/set_pass_company.html"><i class="fa fa-table"></i><span class="text">确定竞标企业</span></a></li>
                                <li><a href="/System_TenderPlan/set_win_company.html"><i class="fa fa-table"></i><span class="text">确定中标企业</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-file-text"></i><span class="text">评价报告</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="/System_Assess/check_assess_report.html"><i class="fa fa-pencil"></i><span class="text">查看评价报告</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-font"></i><span class="text">认证</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="#"><i class="fa fa-th"></i><span class="text">企业认证</span></a></li>
                                <li><a href="#"><i class="fa fa-th"></i><span class="text">媒体认证</span></a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="sidebar-footer">

                <div class="sidebar-brand">
                    政府后台
                </div>

            </div>

        </div>
    </div>

    <!-- end:    左侧导航栏   -->

    <!-- start:  招标目录表   -->
    <div class="main sidebar-minified">

        <div class="row">
            <div class="col-lg-12">
                <h3 class="page-header"><i class="fa fa-table"></i>调查表</h3>
                <ol class="breadcrumb">
                    <li><i class="fa fa-home"></i><a href="Home.html">主页</a></li>
                    <li><i class="fa fa-table"></i>调查表</li>
                </ol>
            </div>
        </div>

        <div class="form-group">
            <div class="row">
                <div class="col-md-2 text-center" for="name_input" ><h5 class="h5"><strong>调查表名字:</strong></h5></div>
                <div class="col-md-3">
                    <input type="text" id="DemandTable_input" name="text_input" class="form-control" placeholder="调查表名字"
                           data-toggle="modal" data-target="#DemandTableModal">
                </div>
                    <button id="searchInfo" class="btn btn-success">查询</button>
                    <button id="del" class="btn btn-danger">删除</button>
            </div>
        </div>

        <!--  已发布项目  -->
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h2><i class="fa fa-table red"></i><span class="break"></span><strong>调查记录</strong></h2>
                    </div>
                    <div class="panel-body">
                        <table id="DetailTable" data-toggle="table">
                            <thead>
                            <tr>
                                <th data-field="demand_Name">需求名</th>
                                <th data-field="votes">投票数</th>
                            </tr>
                            </thead>
                        </table>

                    </div>
                </div>
            </div><!--/col-->
        </div><!--/row-->
    </div>
</div>
<br><br><br>
<div class="modal fade" id="myModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Modal title</h4>
            </div>
            <div class="modal-body">
                <p>Here settings can be configured...</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--这段是悬浮窗的代码-->
<div class="modal fade" id="DemandTableModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">调查表</h4>
            </div>
            <div class="modal-body">
                <table id="DemandTable" data-toggle="table"  data-url="/Demand/ShowAll" >
                    <thead>
                    <tr>
                        <th data-field="demandTable_ID">调查表ID</th>
                        <th data-field="demandTable_Name">调查表名</th>
                        <th data-field="demandTable_StartTime">开始时间</th>
                        <th data-field="demandTable_EndTime">结束时间</th>
                        <th data-field="demandTable_State" data-formatter="StateFormatter" data-events="StateEvents">State</th>
                        <th data-field="action" data-formatter="actionFormatter" data-events="DemandactionEvents">添加</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- start: JavaScript-->
<!--[if !IE]>-->

<script src="../asset/js/jquery-2.1.1.min.js"></script>
<!--<![endif]-->
<!--[if IE]>
<script src="../asset/js/jquery-2.1.1.min.js"></script>
<![endif]-->
<!--[if !IE]>>
<script type="text/javascript">
    window.jQuery || document.write("<script src='assets/js/jquery-2.1.1.min.js'>"+"<"+"/script>");
</script>
<!<![endif]-->
<!--[if IE]>
<script type="text/javascript">
    window.jQuery || document.write("<script src='assets/js/jquery-1.11.1.min.js'>"+"<"+"/script>");
</script>
<![endif]-->
<script src="../asset/js/jquery-migrate-1.2.1.min.js"></script>
<script src="../asset/js/bootstrap.min.js"></script>
<!-- page scripts -->
<script src="../asset/plugins/jquery-ui/js/jquery-ui-1.10.4.min.js"></script>
<script src="../asset/plugins/datatables/js/jquery.dataTables.min.js"></script>
<script src="../asset/plugins/datatables/js/dataTables.bootstrap.min.js"></script>
<!-- theme scripts -->
<script src="../asset/js/SmoothScroll.js"></script>
<script src="../asset/js/jquery.mmenu.min.js"></script>
<script src="../asset/js/core.min.js"></script>
<!-- end: JavaScript-->
<script src="../asset/js/jquery-2.1.1.min.js"></script>
<script src="../asset/js/avalon.js"></script>
<!-- Latest compiled and minified CSS -->
<!-- <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.css"> -->
<script src="../js/bootstrap.min.js"></script>
<script src="../js/jquery-3.2.1.min.js"></script>
<script src="../js/bootstrap-table.js"></script>
<script src="../js/bootstrap-table-zh-CN.min.js"></script>
<!---->
<!--以下代码是实现查看详情 的js代码-->
<!---->
<script>
    var DemandTableID;
    $('#DemandTable').bootstrapTable({
        method:'post',
        dataType:'json',
        pagination: true,                   //是否显示分页（*）
        pageSize: 10 //每页的记录行数（*）

    });
    function StateFormatter(value, row, index) {
        if(row['demandTable_State']==0)
            return '<span class="label label-primary">正在进行</span>';
        else if(row['demandTable_State']==1)
            return '<span class="label label-danger">已经完成</span>';
    }
    function actionFormatter(value, row, index) {

        return [
            '<a class="like" href="javascript:void(0)" title="Like" data-dismiss="modal">',
            '<i class="glyphicon glyphicon-plus"></i>',
            '</a>'
        ].join('');
    }
    window.DemandactionEvents = {
        'click .like': function (e, value, row, index) {
            document.getElementById("DemandTable_input").value=row['demandTable_Name'];
            DemandTableID = row['demandTable_ID'];
        }
    };

    $('#DemandTable_input').click(function (){
        //隐藏ID列
        $('#DemandTable').bootstrapTable('hideColumn', 'demandTable_ID');
        //重新加载悬浮窗TenderPlanTable数据
        $.ajax({
            type: "POST",
            url:"/Demand/ShowAll",
            success: function(msg){
                $('#DemandTable').bootstrapTable('load',msg);
            }
        });
    });

    $('#searchInfo').click(function (){
        var name=document.getElementById("DemandTable_input").value;
        //根据招标计划ID查询对应companyinfo
        if (name != "") {
            $.ajax({
                type: "POST",
                url: "/Demand/showDemandView?DemandTable_ID=" + DemandTableID,
                success: function (msg) {
                    $('#DetailTable').bootstrapTable('load', msg);
                }
            });
        }
        else
        {
            alert("请选择一个调查表!");
        }
    });

    $('#del').click(function () {
        var name=document.getElementById("DemandTable_input").value;
        if (name != ""){
            var mymessage=confirm("确定删除吗?");
            //根据招标计划ID删除对应table以及detail
            if (mymessage == true) {
                $.ajax({
                    type: "POST",
                    url: "/Demand/DeleteTableDetail?DemandTable_ID=" + DemandTableID,
                    success: function (msg) {
                        alert("删除“" + name + "”成功");
                        window.location.reload();
                    }
                });
            }
        }
        else
        {
            alert("请选择一个调查表!");
        }
    });
</script>
</body>
</html>