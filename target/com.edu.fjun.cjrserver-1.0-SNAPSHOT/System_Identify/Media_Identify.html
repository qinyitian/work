<!DOCTYPE html>
<html  xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>第三方评价机构注册认证</title>
    <!-- Import google fonts - Heading first/ text second -->
    <!-- <link rel='stylesheet' type='text/css' href='http://fonts.useso.com/css?family=Open+Sans:400,700|Droid+Sans:400,700' /> -->
    <!--[if lt IE 9]>
    <link href="http://fonts.useso.com/css?family=Open+Sans:400" rel="stylesheet" type="text/css" />
    <link href="http://fonts.useso.com/css?family=Open+Sans:700" rel="stylesheet" type="text/css" />
    <link href="http://fonts.useso.com/css?family=Droid+Sans:400" rel="stylesheet" type="text/css" />
    <link href="http://fonts.useso.com/css?family=Droid+Sans:700" rel="stylesheet" type="text/css" />
    <![endif]-->
    <!-- Favicon and touch icons -->
    <link rel="shortcut icon" href="../asset/ico/favicon.ico" type="image/x-icon" />
    <!-- Css files -->
    <link href="../asset/css/bootstrap.min.css" rel="stylesheet">
    <link href="../asset/css/jquery.mmenu.css" rel="stylesheet">
    <link href="../asset/css/font-awesome.min.css" rel="stylesheet">
    <link href="../asset/plugins/jquery-ui/css/jquery-ui-1.10.4.min.css" rel="stylesheet">
    <link href="../asset/css/style.min.css" rel="stylesheet">
    <link href="../asset/css/add-ons.min.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="../asset/js/html5shiv.js"></script>
    <script src="../asset/js/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- start: Header -->
<div class="navbar" role="navigation">
    <div class="container-fluid">
        <ul class="nav navbar-nav navbar-right">
            <li class="dropdown visible-md visible-lg">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><img class="user-avatar" src="../asset/img/avatar.jpg" alt="user-mail">政府后台管理员</a>
            </li>
            <li><a href="Home.html"><i class="fa fa-power-off"></i></a></li>
        </ul>
    </div>
</div>
<!-- end: Header -->
<!-- start:    左侧导航栏    -->
<div class="container-fluid content">
    <div class="row">
        <!-- start: Main Menu -->
        <div class="sidebar ">
            <div class="sidebar-collapse">
                <div class="sidebar-header t-center">
                    	<br>
                    <h2>政府后台</h2>
                </div>
                <div class="sidebar-menu">
                    <ul class="nav nav-sidebar">
                        <li><a href="Home.html"><i class="fa fa-laptop"></i><span class="text">主页</span></a></li>
                        <li>
                            <a href="#"><i class="fa fa-font"></i><span class="text">首页管理</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="../System_Floder/Floder.html"><i class="fa fa-th"></i><span class="text">头部导航栏管理</span></a></li>
                                <li><a href="../System_Floder/Article_management.html"><i class="fa fa-th"></i><span class="text">文章管理</span></a></li>
                                <li><a href="../System_Floder/Content_management.html"><i class="fa fa-th"></i><span class="text">内容管理</span></a></li>
                                <li><a href="../System_Floder/Information.html"><i class="fa fa-th"></i><span class="text">底部导航栏管理</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-file-text"></i><span class="text">招标</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="../System_TenderPlan/publish_tender_plan.html"><i class="fa fa-pencil"></i><span class="text">发布招标计划</span></a></li>
                                <li><a href="../System_TenderPlan/tender_form.html"><i class="fa fa-table"></i><span class="text">公布招标结果</span></a></li>
                                <li><a href="../System_TenderPlan/BidingResult.html"><i class="fa fa-table"></i><span class="text">查看招标结果</span></a></li>
                                <li><a href="../System_TenderPlan/goverment_check_evalution.html"><i class="fa fa-table"></i><span class="text">查看服务评价</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-signal"></i><span class="text">需求</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                 <li><a href="../System_Demand/issue_EquipmentContent.html"><i class="fa fa-table"></i><span class="text">需求调查表</span></a></li>
                                <li><a href="../System_Demand/demand_form.html"><i class="fa fa-list"></i><span class="text">调查表</span></a></li>
                                <li><a href="../System_Demand/equipment_service.html"><i class="fa fa-list"></i><span class="text">器材管理</span></a></li>
                                <li><a href="../System_Demand/field_service.html"><i class="fa fa-list"></i><span class="text">场地服务管理</span></a></li>
                                <li><a href="../System_Demand/activity_service.html"><i class="fa fa-list"></i><span class="text">活动服务管理</span></a></li>
                                <li><a href="../System_Demand/sport_service.html"><i class="fa fa-list"></i><span class="text">赛事服务管理</span></a></li>
                                <li><a href="../System_Demand/artificial_service.html"><i class="fa fa-list"></i><span class="text">人工服务管理</span></a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-font"></i><span class="text">认证</span> <span class="fa fa-angle-down pull-right"></span></a>
                            <ul class="nav sub">
                                <li><a href="Company_Identify.html"><i class="fa fa-th"></i><span class="text">企业认证</span></a></li>
                                <li><a href="Media_Identify.html"><i class="fa fa-th"></i><span class="text">媒体认证</span></a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="sidebar-footer">
                <div class="sidebar-brand">
                    政府后台
                </div>
            </div>
        </div>
    </div>
    <!-- end:    左侧导航栏   -->
    <!-- start:  招标目录表   -->
    <div class="main sidebar-minified">
        <div class="row">
            <div class="col-lg-12">
                <h3 class="page-header"><i class="fa fa-table"></i>媒体认证</h3>
                <ol class="breadcrumb">
                    <li><i class="fa fa-home"></i><a href="Home.html">主页</a></li>
                    <li><i class="fa fa-table"></i>媒体认证</li>
                </ol>
            </div>
        </div>
        <!--  未认证的企业  -->
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h2><i class="fa fa-table red"></i><span class="break"></span><strong>未认证企业</strong></h2>
                        <div class="panel-actions">
                            <a href="table.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="panel-body">
                        <table data-toggle="table" id="MediaTable">
                            <thead>
                            <tr>
                                <th data-checkbox="true"></th>
                                <th data-field="media_ID" data-visible="false">媒体ID</th>
                                <th data-field="media_Name">媒体名</th>
                                <th data-field="phone">电话</th>
                                <th data-field="invite_code">邀请码</th>
                                <th data-field="action" data-formatter="actionFormatter" data-events="actionEvents">查看</th>
                            </tr>
                            </thead>
                        </table>
                        <div class="col-md-1 col-md-offset-11">
                            <button id="PassIdentify" class="btn btn-success">通过申请</button>
                        </div>
                    </div>
                </div>
            </div><!--/col-->
        </div><!--/row-->
        <!--认证通过企业-->
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h2><i class="fa fa-table red"></i><span class="break"></span><strong>认证通过企业</strong></h2>
                        <div class="panel-actions">
                            <a href="table.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="panel-body">
                        <table data-toggle="table" id="PassTable">
                            <thead>
                            <tr>
                                <th data-field="media_ID" data-visible="false">媒体ID</th>
                                <th data-field="media_Name">媒体名</th>
                                <th data-field="phone">电话</th>
                                <th data-field="invite_code">邀请码</th>
                                <th data-field="action" data-formatter="actionFormatter" data-events="actionEvents">查看</th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div><!--/col-->
        </div><!--/row-->
    </div>
</div>
<br><br><br>
<!--这段是悬浮窗的代码-->
<div class="modal fade" id="MediaModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">招标选择</h4>
            </div>
            <div class="modal-body">
                <table id="MediaInfoTable" data-toggle="table">
                    <thead>
                    <tr>
                        <th data-field="media_Name">媒体名字</th>
                        <th data-field="address">地址</th>
                        <th data-field="email">电子邮箱</th>
                        <th data-field="category">类别</th>
                        <th data-field="introduction">描述</th>
                    </tr>
                    </thead>
                </table>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <!--<button id="GetTenderName" type="button" class="btn btn-primary" id="GetTenderPlanID">确定</button>-->
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- start: JavaScript-->
<!--[if !IE]>-->
<script src="../asset/js/jquery-2.1.1.min.js"></script>
<!--<![endif]-->
<!--[if IE]>
<script src="../asset/js/jquery-2.1.1.min.js"></script>
<![endif]-->
<!--[if !IE]>
<script type="text/javascript">
    window.jQuery || document.write("<script src='assets/js/jquery-2.1.1.min.js'>"+"<"+"/script>");
</script>
<!<![endif]-->
<!--[if IE]>
<script type="text/javascript">
    window.jQuery || document.write("<script src='assets/js/jquery-1.11.1.min.js'>"+"<"+"/script>");
</script>
<![endif]-->
<script src="../asset/js/jquery-migrate-1.2.1.min.js"></script>
<script src="../asset/js/bootstrap.min.js"></script>
<!-- page scripts -->
<script src="../asset/plugins/jquery-ui/js/jquery-ui-1.10.4.min.js"></script>
<script src="../asset/plugins/datatables/js/jquery.dataTables.min.js"></script>
<script src="../asset/plugins/datatables/js/dataTables.bootstrap.min.js"></script>
<!-- theme scripts -->
<script src="../asset/js/SmoothScroll.js"></script>
<script src="../asset/js/jquery.mmenu.min.js"></script>
<script src="../asset/js/core.min.js"></script>
<!-- end: JavaScript-->
<script src="../asset/js/jquery-2.1.1.min.js"></script>
<script src="../asset/js/avalon.js"></script>
<!-- Latest compiled and minified CSS -->
<!-- <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.css"> -->
<script src="../js/bootstrap.min.js"></script>
<script src="../js/jquery-3.2.1.min.js"></script>
<script src="../js/bootstrap-table.js"></script>
<script src="../js/bootstrap-table-zh-CN.min.js"></script>
<!---->
<!--以下代码是实现查看详情 的js代码-->
<!---->
<script>
    $('#MediaTable').bootstrapTable({
        method:'post',
        dataType:'json',
        url:"/Register/Media_Identify",
        pagination: true,                   //是否显示分页（*）
        pageSize: 10 //每页的记录行数（*）
    });
    $('#PassTable').bootstrapTable({
        method:'post',
        dataType:'json',
        url:"/Register/MediaIdentifyPass",
        pagination: true,                   //是否显示分页（*）
        pageSize: 10 //每页的记录行数（*）
    });
    function actionFormatter(value, row, index) {
        return [
            '<button type="button" class="btn btn-default" data-toggle="modal" data-target="#MediaModal">查看详情</button>'
        ].join('');
    }
    window.actionEvents = {
        'click .btn': function (e, value, row, index) {
            $.ajax({
                type: "POST",
                url:"/Register/MediaInfo_Identify?Media_Name="+row['media_Name'],
                success: function(msg){
                    //这里的msg是json对象，不是json字符串。
                    $('#MediaInfoTable').bootstrapTable('load',msg);
                }
            });
        }
    };
    //company_ID
    //    认证代码
    $('#PassIdentify').click(function () {
        var ids = $.map($('#MediaTable').bootstrapTable('getSelections'), function (row) {
            return row.id;
        });
        $('#MediaTable').bootstrapTable('remove', {
            field: 'id',
            values: ids
        });
        var AllCompanyTable =$('#MediaTable').bootstrapTable('getSelections');
        //获取悬浮框数据
        var MediaIDList = new Array();
        var allTableData = JSON.stringify(AllCompanyTable);
        //获取json中demand_ID,生成数组
        for(var i=0;i<eval(allTableData).length;i++)
        {
            MediaIDList[i]=AllCompanyTable[i].media_ID;//这里不能用已经转换的JSON格式，要用原本的
        }
        $.ajax({
            type:"post",
            traditional: true,
            url: "/Register/successMediaIdentify",//请求地址
            data: { "List": MediaIDList},//向后台提交的参数
            success: function(data) {
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
            }
        })
        $.ajax({
            type:"post",
            traditional: true,
            url: "/Register/updateMedia",//请求地址
            data: { "MediaIDList": MediaIDList},//向后台提交的参数
            success: function(data) {
                $('#MediaTable').bootstrapTable('load',data);
                alert("认证成功");
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
            }

        })
    });

</script>
</body>
</html>